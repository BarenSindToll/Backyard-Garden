{"version":3,"file":"react-use-image.esm.js","sources":["../src/index.tsx"],"sourcesContent":["import { useEffect, useRef, useState } from 'react';\n\n// interface Window extends EventTarget {\ndeclare interface Window extends EventTarget {\n  readonly window: Window & typeof globalThis;\n  Image: {\n    prototype: HTMLImageElement;\n    new (): HTMLImageElement;\n  };\n}\n\ninterface SizedTarget {\n  width: number;\n  height: number;\n}\n\n// type WindowProps = React.HTMLProps<HTMLElement>;\n\n// interface WindowComponent extends React.StatelessComponent<WindowProps> {\n//     (props: WindowProps): React.ReactElement<HTMLElement>;\n// }\n\nconst useImage = (src: string) => {\n  const ready = useRef(true);\n  const [loaded, setLoaded] = useState(false);\n  const [failed, setFailed] = useState(false);\n  const [dimensions, setDimensions] = useState({\n    width: 0,\n    height: 0,\n  });\n\n  useEffect(() => {\n    const win: Window = window;\n    const { Image } = win;\n\n    if (!src || !Image) {\n      return;\n    }\n\n    const image = new Image();\n\n    function isSizedTarget(t: any): t is SizedTarget {\n      return t && t.width !== undefined && t.height !== undefined;\n    }\n\n    image.onload = event => {\n      if (ready.current) {\n        if (isSizedTarget(event.target)) {\n          const { width, height } = event.target;\n          setLoaded(true);\n          setDimensions({ width, height });\n        }\n      }\n    };\n\n    image.onerror = () => {\n      if (ready.current) {\n        setLoaded(false);\n        setFailed(true);\n      }\n    };\n\n    image.src = src;\n  }, [src]);\n\n  useEffect(() => {\n    return () => {\n      ready.current = false;\n    };\n  }, []);\n\n  return { loaded, failed, dimensions };\n};\n\nexport default useImage;\n"],"names":["useImage","src","ready","useRef","useState","loaded","setLoaded","failed","setFailed","width","height","dimensions","setDimensions","useEffect","win","window","Image","image","isSizedTarget","t","undefined","onload","event","current","target","onerror"],"mappings":";;AAkBA;AACA;AACA;;AAEA,IAAMA,QAAQ,GAAG,SAAXA,QAAW,CAACC,GAAD;AACf,MAAMC,KAAK,GAAGC,MAAM,CAAC,IAAD,CAApB;;kBAC4BC,QAAQ,CAAC,KAAD;MAA7BC;MAAQC;;mBACaF,QAAQ,CAAC,KAAD;MAA7BG;MAAQC;;mBACqBJ,QAAQ,CAAC;AAC3CK,IAAAA,KAAK,EAAE,CADoC;AAE3CC,IAAAA,MAAM,EAAE;AAFmC,GAAD;MAArCC;MAAYC;;AAKnBC,EAAAA,SAAS,CAAC;AACR,QAAMC,GAAG,GAAWC,MAApB;QACQC,QAAUF,IAAVE;;AAER,QAAI,CAACf,GAAD,IAAQ,CAACe,KAAb,EAAoB;AAClB;AACD;;AAED,QAAMC,KAAK,GAAG,IAAID,KAAJ,EAAd;;AAEA,aAASE,aAAT,CAAuBC,CAAvB;AACE,aAAOA,CAAC,IAAIA,CAAC,CAACV,KAAF,KAAYW,SAAjB,IAA8BD,CAAC,CAACT,MAAF,KAAaU,SAAlD;AACD;;AAEDH,IAAAA,KAAK,CAACI,MAAN,GAAe,UAAAC,KAAK;AAClB,UAAIpB,KAAK,CAACqB,OAAV,EAAmB;AACjB,YAAIL,aAAa,CAACI,KAAK,CAACE,MAAP,CAAjB,EAAiC;AAAA,8BACLF,KAAK,CAACE,MADD;AAAA,cACvBf,KADuB,iBACvBA,KADuB;AAAA,cAChBC,MADgB,iBAChBA,MADgB;AAE/BJ,UAAAA,SAAS,CAAC,IAAD,CAAT;AACAM,UAAAA,aAAa,CAAC;AAAEH,YAAAA,KAAK,EAALA,KAAF;AAASC,YAAAA,MAAM,EAANA;AAAT,WAAD,CAAb;AACD;AACF;AACF,KARD;;AAUAO,IAAAA,KAAK,CAACQ,OAAN,GAAgB;AACd,UAAIvB,KAAK,CAACqB,OAAV,EAAmB;AACjBjB,QAAAA,SAAS,CAAC,KAAD,CAAT;AACAE,QAAAA,SAAS,CAAC,IAAD,CAAT;AACD;AACF,KALD;;AAOAS,IAAAA,KAAK,CAAChB,GAAN,GAAYA,GAAZ;AACD,GAhCQ,EAgCN,CAACA,GAAD,CAhCM,CAAT;AAkCAY,EAAAA,SAAS,CAAC;AACR,WAAO;AACLX,MAAAA,KAAK,CAACqB,OAAN,GAAgB,KAAhB;AACD,KAFD;AAGD,GAJQ,EAIN,EAJM,CAAT;AAMA,SAAO;AAAElB,IAAAA,MAAM,EAANA,MAAF;AAAUE,IAAAA,MAAM,EAANA,MAAV;AAAkBI,IAAAA,UAAU,EAAVA;AAAlB,GAAP;AACD,CAlDD;;;;"}